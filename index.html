<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ä»Šæ—¥å¾…è¾¦ä»»å‹™</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      max-width: 500px;
      margin: auto;
    }
    h1, #stats{
      text-align: center;
    }
    #stats {
      color: #555;
      font-size: 0.9rem;
      margin-bottom: 1.5rem;
    }
    input {
      padding: 0.5rem;
      font-size: 1rem;
      width: 70%;
    }
    #input-area {
      margin-bottom: 1rem;
      display: flex;  /* è®“è£¡é¢çš„æ±è¥¿æ°´å¹³ç½®ä¸­ */
      justify-content: center;  /* å…ƒç´ ä¹‹é–“çš„é–“è· */
      gap: 0.5rem;
    }
    button {
      padding: 0.5rem 1rem;
      font-size: 1rem;
      margin-left: 0.5rem;
    }
    ul {
      list-style: none;
      padding-left: 0;
    }
    li {
      margin-top: 1rem;
      padding: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: grab;
    }
    li.completed span {
      text-decoration: line-through;
      color: #888;
    }
    .delete-btn {
      background: none;
      border: none;
      color: #ff4444;
      font-size: 1.2rem;
      cursor: pointer;
    }
    .delete-btn:hover {
      color: #cc0000;
    }
    #toggle-guide {
      background: #f0f0f0;
      border: none;
      padding: 0.5rem 1rem;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 6px;
      margin-bottom: 1rem;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    #toggle-guide:hover {
      background: #e0e0e0;
    }
    #guide-content ul {
      padding-left: 1rem;
    }
    #notice-container {
      background-color:#ECF5FF;    /*èƒŒæ™¯è‰²*/
      border: 1px solid #bcdffb;       /* é‚Šæ¡† */
      color: #333333;                /* æ–‡å­— */
      border-radius: 6px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);  /* æ·ºé™°å½±ï¼Œæå‡å±¤æ¬¡æ„Ÿ */
      margin-top: 1.5rem;
    }
    #notice-header {
      padding: 0.6rem 0.75rem;
      cursor: pointer;
      font-weight: bold;
      user-select: none;
    }
    #notice-header:hover {      
      background-color: #D6EFFF;
      color: #1A5276;
      cursor: pointer;
    }
    #notice-content {
      padding: 0.75rem;
      border-top: 2px solid #ACD6FF;
      /*display: none; /* é è¨­æ”¶åˆ */
    }
    
  </style>
</head>
<body>
  <h1>ä»Šæ—¥å¾…è¾¦ä»»å‹™</h1>
  <p id="stats">å…± 0 é …ï¼Œå®Œæˆ 0 é …ï¼Œæœªå®Œæˆ 0 é …</p>
  <div id="input-area">
    <!--è¼¸å…¥æ¡†-->
    <input type="text" id="todo-input" placeholder="è«‹è¼¸å…¥å¾…è¾¦ä»»å‹™" />
    <!--æ–°å¢çš„æŒ‰éˆ•-->
    <button id="add-btn">æ–°å¢</button>
  </div>

<div id="notice-container">
  <div id="notice-header">ğŸ“Œ ä½¿ç”¨å°è¦½ï¼ˆæ”¶åˆï¼‰ </div>
  <div id="notice-content">
    å“ˆå›‰ï¼è®“æˆ‘å€‘ä¸€åˆ†é˜å¿«é€Ÿå°è¦½åŠŸèƒ½å§ ğŸ˜Š</br>
    <p>
      [åŸºæœ¬åŠŸèƒ½]</br>
      ğŸ‘‰ğŸ» è¼¸å…¥ä»£è¾¦äº‹é …ï¼ŒæŒ‰ä¸‹Enterã€Œæ–°å¢ã€æŒ‰éˆ•</br>
      ğŸ‘‰ğŸ» æ–°å¢ä»»å‹™å¾Œé»ä¸€ä¸‹è®Šæˆåˆªé™¤ç·šï¼‹æ·ºè‰² æ¨™ç¤ºå®Œæˆ</br>
      ğŸ‘‰ğŸ» é»å…©ä¸‹è·³å‡ºè¨Šæ¯å¯ä»¥é‡æ–°ç·¨è¼¯ï½</br>
      ğŸ‘‰ğŸ» æŒ‰ä½ä»»å‹™é€²è¡Œæ‹–æ›³ï¼Œæ–¹ä¾¿å®‰æ’å…ˆå¾Œé †åºï¼ï¼
    </p>
    <p>
      [å…¶ä»–åŠŸèƒ½]</br>
      ğŸ‘‰ğŸ»å…± 0 é …ï¼Œå®Œæˆ 0 é …ï¼Œæœªå®Œæˆ 0 é …ï¼Œé€™é‚Šæœƒè² è²¬è¨ˆç®—ç›®å‰ç‚ºæ­¢ä»»å‹™ç‹€æ³å–”ï¼
    </p>
  </div>
</div>

  <ul id="todo-list"></ul>

  <script>
    const input = document.getElementById("todo-input");
    const addBtn = document.getElementById("add-btn");
    const todoList = document.getElementById("todo-list");

    let todos = JSON.parse(localStorage.getItem("todos")) || [];

    function renderTodos() {
      todoList.innerHTML = "";
      todos.forEach(function (todo) {
        const li = createTodoElement(todo.text, todo.completed);
        todoList.appendChild(li);
      });
      updateStats();
    }

    function createTodoElement(text, completed = false) {
      const li = document.createElement("li");
      if (completed) li.classList.add("completed");

      const span = document.createElement("span");
      span.textContent = text;

      span.addEventListener("click", function () {
        li.classList.toggle("completed");
        const index = Array.from(todoList.children).indexOf(li);
        todos[index].completed = li.classList.contains("completed");
        saveTodos();
        updateStats();
      });

      span.addEventListener("dblclick", function () {
        const newText = prompt("è«‹è¼¸å…¥æ–°çš„å…§å®¹ï¼š", text);
        if (newText !== null && newText.trim() !== "") {
          span.textContent = newText.trim();
          const index = Array.from(todoList.children).indexOf(li);
          todos[index].text = newText.trim();
          saveTodos();
        }
      });

      const delBtn = document.createElement("button");
      delBtn.textContent = "âœ•";
      delBtn.className = "delete-btn";
      delBtn.addEventListener("click", function (event) {
        event.stopPropagation();
        const index = Array.from(todoList.children).indexOf(li);
        todos.splice(index, 1);
        saveTodos();
        renderTodos();
      });

      li.appendChild(span);
      li.appendChild(delBtn);

      li.setAttribute("draggable", true);
      li.addEventListener("dragstart", dragStart);
      li.addEventListener("dragover", dragOver);
      li.addEventListener("drop", drop);

      return li;
    }

    function saveTodos() {
      localStorage.setItem("todos", JSON.stringify(todos));
    }

    addBtn.addEventListener("click", function () {
      const text = input.value.trim();
      if (text !== "") {
        todos.push({ text: text, completed: false });
        input.value = "";
        renderTodos();
        saveTodos();
      }
    });

    input.addEventListener("keydown", function (event) {
      if (event.key === "Enter") {
        addBtn.click();
      }
    });

    let draggedItem = null;

    function dragStart(e) {
      draggedItem = e.target;
    }

    function dragOver(e) {
      e.preventDefault();
      const target = e.target.closest("li");
      if (target && target !== draggedItem) {
        const children = Array.from(todoList.children);
        const draggedIndex = children.indexOf(draggedItem);
        const targetIndex = children.indexOf(target);

        if (draggedIndex < targetIndex) {
          todoList.insertBefore(draggedItem, target.nextSibling);
        } else {
          todoList.insertBefore(draggedItem, target);
        }

        const newTodos = Array.from(todoList.children).map(li => {
          const text = li.querySelector("span").textContent;
          const completed = li.classList.contains("completed");
          return { text, completed };
        });
        todos = newTodos;
        saveTodos();
      }
    }

    function drop() {
      draggedItem = null;
    }

    function updateStats() {
      const total = todos.length;
      const completed = todos.filter(todo => todo.completed).length;
      const uncompleted = total - completed;
      document.getElementById("stats").textContent =
        `å…± ${total} é …ï¼Œå®Œæˆ ${completed} é …ï¼Œæœªå®Œæˆ ${uncompleted} é …`;
    }

    window.addEventListener("DOMContentLoaded", renderTodos);

    const noticeHeader = document.getElementById("notice-header");
    const noticeContent = document.getElementById("notice-content");

    noticeHeader.addEventListener("click", function () {
      const isVisible = noticeContent.style.display !== "none";
      noticeContent.style.display = isVisible ? "none" : "block";
      noticeHeader.textContent = isVisible ? "ğŸ“Œä½¿ç”¨å°è¦½ï¼ˆå±•é–‹ï¼‰" : "ğŸ“Œä½¿ç”¨å°è¦½ï¼ˆæ”¶åˆï¼‰";
    });

  </script>
</body>
</html>
